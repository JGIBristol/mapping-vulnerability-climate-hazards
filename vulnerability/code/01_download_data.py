import requests

import config


def download_data(url, output_file):
    if not output_file.exists():
        print(f'Downloading {url}...')
        response = requests.get(url)
        response.raise_for_status()
        with output_file.open('wb') as f:
            f.write(response.content)

            
if __name__ == '__main__':
    config.raw_data_dir.mkdir(parents=True, exist_ok=True)
    
    for data_source in config.data_sources:
        download_data(
            url=data_source['url'],
            output_file=config.raw_data_dir / config.get_download_filename(data_source),
        )
