from pathlib import Path
import yaml


root_dir = Path(__file__).parent.parent
raw_data_dir = root_dir / 'data/01_raw'
subset_data_dir = root_dir / 'data/02_subset'
combined_data_dir = root_dir / 'data/03_combined'
indicators_data_dir = root_dir / 'data/04_indicators'
resampled_data_dir = root_dir / 'data/05_resampled'


with open(root_dir / 'data_sources.yaml') as f:
    data_sources = yaml.safe_load(f)

    
def get_download_filename(data_source):
    try:
        return data_source['output_file']
    except KeyError:
        # Derive filename from the url
         return data_source['url'].split('/')[-1]


def get_data_source(name):
    for data_source in data_sources:
        if data_source['name'] == name:
            return data_source
    raise KeyError(f'Data source "{name}" not found.')
        
    
def filter_data_sources(**kwargs):
    return [
        data_source
        for data_source in data_sources
        if data_source.items() >= kwargs.items()
    ]
